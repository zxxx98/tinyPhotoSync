# 文件夹上传功能说明

## 🎯 功能概述

现在 PhotoSync 支持文件夹上传功能，特别针对手机端用户优化。用户可以选择一个包含图片的文件夹，系统会自动识别其中的所有图片文件并按照多文件上传的逻辑进行处理。

## ✨ 新增功能

### 1. 文件夹选择
- 在上传页面新增"选择文件夹"按钮
- 支持 `webkitdirectory` 属性，可以递归读取文件夹中的所有文件
- 自动过滤出图片文件（JPEG、PNG、GIF、WebP、HEIC、HEIF）

### 2. 移动端优化
- 自动检测移动端设备
- 为移动端用户提供专门的提示信息
- 优化触摸交互体验

### 3. 智能文件处理
- 自动过滤非图片文件
- 检查文件大小限制（10MB）
- 跳过超大文件并提示用户
- 显示找到的图片数量

## 🔧 技术实现

### 客户端修改
- 添加 `webkitdirectory="true"` 属性到文件输入框
- 实现 `handleFolderUpload` 函数处理文件夹选择
- 移动端检测和设备适配
- UI 优化和用户体验提升

### 服务端支持
- 现有的多文件上传 API 无需修改
- 继续使用 `upload.array('photos', 10)` 处理多个文件
- 保持原有的文件大小和类型限制

## 📱 移动端使用说明

### Android 设备
1. 点击"选择文件夹"按钮
2. 在文件管理器中选择包含图片的文件夹
3. 系统会自动读取文件夹中的所有图片
4. 确认选择后开始上传

### iOS 设备
1. 点击"选择文件夹"按钮
2. 在文件应用中选择文件夹
3. 系统会递归读取所有子文件夹中的图片
4. 确认选择后开始上传

## ⚠️ 注意事项

### 浏览器兼容性
- Chrome/Edge: 完全支持
- Firefox: 支持
- Safari: 部分支持（iOS 13+）
- 移动端浏览器: 支持程度因浏览器而异

### 文件限制
- 单次最多选择 10 个文件
- 单个文件最大 10MB
- 支持递归读取子文件夹
- 自动过滤非图片文件

### 性能考虑
- 大量文件时建议分批上传
- 网络不稳定时建议使用单文件上传
- 文件夹上传适合批量整理照片

## 🚀 使用方法

1. 打开上传页面
2. 选择以下任一方式：
   - 拖拽单个或多个文件到上传区域
   - 点击上传区域选择文件
   - 点击"选择文件夹"按钮选择整个文件夹
3. 系统会自动处理文件并显示预览
4. 点击"开始上传"完成上传

## 🔍 故障排除

### 文件夹选择无响应
- 检查浏览器是否支持 `webkitdirectory`
- 尝试使用 Chrome 或 Edge 浏览器
- 确认文件夹中包含图片文件

### 文件未正确识别
- 检查文件格式是否在支持列表中
- 确认文件大小不超过 10MB
- 检查文件是否损坏

### 移动端体验问题
- 更新浏览器到最新版本
- 使用系统自带的文件管理器
- 避免选择过大的文件夹
